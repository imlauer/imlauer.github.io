â¬†ï¸ Up

------------------------------------------------------------------------

Source: https://vaibhavsagar.com/blog/2019/09/08/popcount

------------------------------------------------------------------------

POPCOUNT and the NSA

------------------------------------------------------------------------

popcount is a CPU instruction whose only purpose is to count how many
bits are set to 1 inside a binary word (8 bits = 1 byte).

popcount(00100110) == 3 // because there are three â€œ1â€ bits popcount(01100000) == 2 // because there are two â€œ1â€ bits

Each bit that is set to 1 is added to the total. (vaibhavsagar.com)

This is literally all it does: it counts 1s. There is nothing magical
hidden beyond that. (tech-in-japan.github.io)

------------------------------------------------------------------------

ğŸ’» Why does this instruction exist?

ğŸ§® Real-world uses of popcount

1.  Cryptography and data analysis
    Determining how many bits are active in encrypted or encoded data is
    part of analysis/attack algorithms.
2.  Error detection and correction
    The Hamming distance is calculated as: popcount(x XOR y)
3.  AI and binary neural networks
    Used for efficient inner products.
4.  Chess engines
    64-bit bitboards â†’ pure popcount.
5.  Data structures and compression
    Hashing, compression, and compact structures.

------------------------------------------------------------------------

âš™ï¸ How does it work internally?

    int popcount(value) {
        int count = 0;
        for (i = 0; i < bits_in_word; i++) {
            if ((value >> i) & 1 == 1) count++;
        }
        return count;
    }

In hardware it can run in a single cycle. (felixcloutier.com)

------------------------------------------------------------------------

ğŸ§¾ Real instruction (x86)

-   takes a source value
-   counts bits set to 1
-   returns the number

dest = number of bits â€œ1â€ in src

------------------------------------------------------------------------

ğŸ¤” Is it always present?

No. Older CPUs like the Intel Core 2 did not have it. (softwareg.com.au)

------------------------------------------------------------------------

ğŸ•µï¸â€â™‚ï¸ NSA and popcount

The NSA pushed the development of hardware bit counting because counting
bits is key to cryptography and espionage.

ğŸ” Cryptography = statistics

  ğŸ‘‰ Does this stream of bits actually look random?

This is where popcount comes in.

ğŸ“Š Example

popcount(data) / total_bits

If it doesnâ€™t give ~50/50 â†’ weak cipher.

ğŸ’£ Hamming distance

popcount(x XOR y)

If only a few bits change â†’ bad algorithm.

------------------------------------------------------------------------

ğŸ§  Why hardware?

-   millions of messages
-   real time
-   maximum speed

Result: dedicated instructions â†’ now in your CPU.

------------------------------------------------------------------------

ğŸ“œ Real history

popcount was not created for games. It was created to break ciphers and
spy.

------------------------------------------------------------------------

ğŸ§  Final summary

-   popcount = counting bits
-   counting bits = statistics
-   statistics = cryptoanalysis
-   cryptoanalysis = NSA

Today you use it for AI or chess, but its origin is espionage.

------------------------------------------------------------------------

Spanish

ğŸ§  Â¿QuÃ© es popcount?

popcount es una instrucciÃ³n de CPU cuyo Ãºnico propÃ³sito es contar
cuÃ¡ntos bits estÃ¡n en 1 dentro de una palabra binaria.

popcount(00100110) == 3 // porque hay tres bits "1" popcount(01100000) == 2 // porque hay dos bits â€œ1â€

Cada bit que estÃ¡ en 1 se suma al total. (vaibhavsagar.com)

Eso es literalmente todo lo que hace: cuenta 1s. Nada mÃ¡gico escondido
mÃ¡s allÃ¡ de eso. (tech-in-japan.github.io)

------------------------------------------------------------------------

ğŸ’» Â¿Por quÃ© existe esta instrucciÃ³n?

ğŸ§® Usos reales de popcount

1.  CriptografÃ­a y anÃ¡lisis de datos
    Determinar cuÃ¡ntos bits estÃ¡n activos en datos cifrados o
    codificados sirve como parte de algoritmos de anÃ¡lisis/ataque.
2.  Errores y correcciÃ³n de datos
    La distancia de Hamming se calcula como: popcount(x XOR y)
3.  IA y redes neuronales binarias
    Usado para productos internos eficientes.
4.  Motores de ajedrez
    Bitboards de 64 bits â†’ popcount puro.
5.  Estructuras de datos y compresiÃ³n
    Hashing, compresiÃ³n y estructuras compactas.

------------------------------------------------------------------------

âš™ï¸ Â¿CÃ³mo funciona internamente?

int popcount(value) { int count = 0; for (i = 0; i < bits_in_word; i++) { if ((value >> i) & 1 == 1) count++; } return count; }

En hardware puede ejecutarse en un solo ciclo. (felixcloutier.com)

------------------------------------------------------------------------

ğŸ§¾ InstrucciÃ³n real (x86)

-   toma un valor fuente
-   cuenta bits en 1
-   devuelve el nÃºmero

dest = nÃºmero de bits â€œ1â€ de src

------------------------------------------------------------------------

ğŸ¤” Â¿Siempre estÃ¡ presente?

No. CPUs viejos como Intel Core 2 no la tenÃ­an. (softwareg.com.au)

------------------------------------------------------------------------

ğŸ•µï¸â€â™‚ï¸ NSA y popcount

La NSA empujÃ³ el desarrollo de hardware para contar bits porque contar
bits es clave en cripto y espionaje.

ğŸ” CriptografÃ­a = estadÃ­stica

  ğŸ‘‰ Â¿Este flujo de bits parece realmente aleatorio?

AhÃ­ entra popcount.

ğŸ“Š Ejemplo

popcount(datos) / total_bits

Si no da ~50/50 â†’ cifrado dÃ©bil.

ğŸ’£ Distancia de Hamming

popcount(x XOR y)

Si pocos bits cambian â†’ algoritmo malo.

------------------------------------------------------------------------

ğŸ§  Â¿Por quÃ© en hardware?

-   millones de mensajes
-   tiempo real
-   mÃ¡xima velocidad

Resultado: instrucciones dedicadas â†’ hoy en tu CPU.

------------------------------------------------------------------------

ğŸ“œ Historia real

popcount no naciÃ³ para juegos. NaciÃ³ para romper cifrados y espiar.

------------------------------------------------------------------------

ğŸ§  Resumen final

-   popcount = contar bits
-   contar bits = estadÃ­stica
-   estadÃ­stica = criptoanÃ¡lisis
-   criptoanÃ¡lisis = NSA

Hoy lo usÃ¡s para IA o ajedrez, pero el origen es espionaje.
