<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Imlauer | just_tty </title>
</head>
<body>
<hr />
<h2>title: &quot;TTY, Linux Framebuffer, EGLFS and SDL - Without the weight of Xorg or Wayland&quot;
date: 2025-09-13</h2>
<p>Currently, I'm only using EGLFS with ttyd, I start my browser with the following script:</p>
<pre><code class="language-bash">#!/bin/bash
sudo chmod 666 /dev/input/event*

ttyd --port 2020 --writable fish &amp; 

falkon &quot;http://localhost:2020&quot;
</code></pre>
<p>And in <code>.config/fish/config.fish</code> I had:</p>
<pre><code class="language-bash">if test -z &quot;$TMUX&quot; -a $XDG_VTNR = 1
  tmux attach || exec tmux new-session
end
export QT_QPA_PLATFORM=eglfs  
export XKB_DEFAULT_LAYOUT=es
set -U fish_greeting
</code></pre>
<h4><strong>1. TTY Environment Setup</strong></h4>
<p>For efficient management of your terminals and processes, it is essential to use a terminal multiplexer.</p>
<ul>
<li><strong>Start a Terminal Multiplexer Upon Login:</strong>
<ul>
<li>For <code>fish</code> shell, add to the <code>.config/fish/config.fish</code> file:</li>
</ul>
</li>
</ul>
<pre><code class="language-bash">if test -z &quot;$TMUX&quot; -a $XDG_VTNR = 1
  tmux attach || exec tmux new-session
end
</code></pre>
<p>This will automatically start <code>tmux</code> in the tty number 1 (a terminal multiplexer similar to <code>tmux</code>).<br />
<strong>Alternatively, you can use <code>dvtm</code>.</strong></p>
<h4><strong>2. Web Browsing from TTY</strong></h4>
<ul>
<li><strong>Recommended Text Browsers:</strong>
<ul>
<li><strong>w3m</strong>: This browser supports displaying images directly in the console without an additional tool <strong>you can render JavaScript only sites</strong> using headless chromium save it as shell script and set it as external browser in w3m: <code>chromium --headless $1 --disable-gpu --run-all-compositor-stages-before-draw --dump-dom --virtual-time-budget=10000 | sed &quot;s|&lt;head&gt;|&lt;head&gt;&lt;base href=$1&gt;|g&quot; | w3m -T text/html</code>. Scale of image %10. I use w3m from rkta with gemini and gopherhole support try to enter this URL to check if your web browser supports gopher: <a href="gopher://self.tastyfish.cz/1">gopher</a>.</li>
<li><strong><a href="https://sr.ht/~bptato/chawan/">chawan</a></strong>.</li>
<li><strong>Install <code>fbida</code></strong>:</li>
</ul>
</li>
</ul>
<h4><strong>3. Multimedia Viewing: Images, PDFs, and Videos</strong></h4>
<ul>
<li>
<p><strong>View Images in TTY (with <code>fbi</code> and <code>mpv</code>):</strong></p>
<ul>
<li>Install <code>fbida</code>: <code>pacman -S fbida</code>. You can use <code>fbi</code> (part of <code>fbida</code>) to view images: <code>fbi image.jpg</code> or <code>fim image.jpg</code>.</li>
<li><code>mpv</code> can also be used to view images.</li>
</ul>
</li>
<li>
<p><strong>Read PDFs from the TTY:</strong></p>
<ul>
<li><strong><code>fbpdf</code></strong>:  <code>fbpdf document_name.pdf</code></li>
<li>Alternatively, you can use any KDE application to open a pdf too.</li>
</ul>
</li>
<li>
<p><strong>Watch Videos (YouTube, Twitch) from the TTY:</strong></p>
<ul>
<li><strong><code>w3m</code> with Invidious</strong>:
<ul>
<li>Browse to Invidious (e.g., <code>inv.nadeko.net</code>) with <code>w3m</code>.</li>
<li>Configure <code>mpv</code> as the default browser in <code>w3m</code>. When accessing the video URL, press <strong><code>Shift+M</code></strong> to open it with <code>mpv</code> or <strong><code>Escape+Shift+M</code></strong>.</li>
</ul>
</li>
<li><strong><code>mpv</code> for Twitch</strong>:
<ul>
<li>You can use <code>mpv</code> to watch Twitch streams (you will have to run mpv with <code>--ignore-config</code> if you're using mpv with YouTube settings.</li>
</ul>
</li>
<li><strong>Video Playback in DRM</strong>:  <code>mpv --vo=drm video.mp4</code></li>
<li><strong><code>mpv</code> and <code>invidious</code> for YouTube</strong>:
<ul>
<li><code>alias invidious 'w3m https://inv.nadeko.net/feed/subscriptions'</code> and set <code>mpv</code> as default browser.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4>My <code>/etc/mpv/mpv.conf</code>:</h4>
<pre><code class="language-bash">$ cat /etc/mpv/mpv.conf  
--profile=fast  
--sub-auto=all  
--vo=drm
--ytdl-raw-options=&quot;format=bestvideo[height&lt;=?360]+bestaudio/best[height&lt;=?360]/bestvideo[height&lt;=?480]+bestaudio/best[height&lt;=?480],write-auto-sub=,sub-lang=[es,en,ru],write-sub=&quot;  
--volume-max=600  
#--save-position-on-quit  
#--untimed  
#--profile=low-latency  
--mute=yes  
</code></pre>
<h4>My <code>/etc/yt-dlp.conf</code>:</h4>
<pre><code class="language-bash">$ cat /etc/yt-dlp.conf  
--format=233+230  
--write-auto-sub  
--write-sub  
--sub-lang=en  
#--cookies-from-browser firefox  
</code></pre>
<p><strong>Important</strong>: If you use <code>mpv</code> for videos, run it outside <code>tmux</code>; otherwise, you won't be able to switch between other TTYs.</p>
<ul>
<li><strong>Search Torrents:</strong>
<ul>
<li>Use <code>jackett</code> and <code>btstrm</code> to search for torrents from the console.</li>
</ul>
</li>
</ul>
<h4><strong>4. Using Lightweight Graphical Applications in TTY (FrameBuffer: <code>eglfs</code> and <code>linuxfb</code>)</strong></h4>
<ul>
<li><strong>Set environment Variables for <code>eglfs</code> and <code>linuxfb</code>:</strong><br />
To enable/disable <code>gpu</code>.</li>
</ul>
<pre><code class="language-bash">#export QTWEBENGINE_CHROMIUM_FLAGS=&quot;--ignore-gpu-blacklist --disable-gpu&quot;
export QTWEBENGINE_CHROMIUM_FLAGS=&quot;--ignore-gpu-blacklist&quot;
</code></pre>
<ul>
<li><strong>Use <code>export XKB_DEFAULT_LAYOUT=es</code> to set your keyboard distribution.</strong></li>
<li>To use <code>eglfs</code>:</li>
</ul>
<pre><code class="language-bash">export QT_QPA_PLATFORM=eglfs  
</code></pre>
<p>Then, start your Qt application (e.g., <code>qutebrowser</code>).</p>
<ul>
<li>To use <code>linuxfb</code>:</li>
</ul>
<pre><code class="language-bash">export QT_QPA_PLATFORM=linuxfb:size=1000x1000  
</code></pre>
<p>To run some applications that normally require a graphical server (like graphical web browsers), you can run it using <code>linuxfb</code> or <code>eglfs</code>.</p>
<h4>Always open Qt apps inside a Terminal Multiplexer, otherwise when the application freezes your entire machine will freeze and you won't be able to use <code>Control+C</code>.</h4>
<h5>In some Linux distributions, you need to run the following command to get the mouse and keyboard working:</h5>
<pre><code class="language-bash">sudo chmod 666 /dev/input/event*
</code></pre>
<ul>
<li>
<p><strong>Graphical Browsers</strong> (with <code>eglfs</code>, <code>linuxfb</code> or <code>sdl</code> support):</p>
<ul>
<li><strong><code>qutebrowser</code> (with <code>eglfs</code>):</strong><br />
Or configure the <code>QT_QPA_PLATFORM</code> environment variable as indicated above.
<ul>
<li><strong>Copy/Paste in <code>qutebrowser</code></strong>: You can use <code>privatebin</code> to copy text from <code>qutebrowser</code>, then access the URL and save the file.</li>
</ul>
</li>
<li><strong><code>falkon</code>:</strong>
<ul>
<li>It can be used with <code>eglfs</code>, although it did not work with <code>linuxfb</code> in one instance.</li>
<li>I use <strong>Android as my User-Agent</strong>: For pages to load faster:</li>
</ul>
</li>
<li><strong>Ad Blocking in <code>Falkon</code> (it's no good)</strong> so I use greasymonkey (still not good).
<ol>
<li>Go to <code>AdBlock settings</code>, and add all non-regional lists (EasyPrivacy, NoCoin List, Anti-Adblock Killer, Peter Lowe's List, etc.).</li>
<li>Go to <code>Settings -&gt; Extensions</code>, and check the box for <code>GreaseMonkey</code>.</li>
<li>Install a YouTube ad-blocking script from <code>https://greasyfork.org</code>.</li>
</ol>
</li>
<li><strong><code>Konqueror</code></strong>: It is a KDE browser that can also be tested in these configurations.</li>
<li><strong><code>NetSurf</code></strong>: Can be run in tty using <code>SDL</code>: <code>netsurf-fb -f sdl -w 1366 -h 768</code>. <code>NetSurf</code> does not have JavaScript support. <em>You can add <code>netsurf-fb -f sdl -w 1366 -h 768</code> as external browser in <code>w3m</code></em>.</li>
</ul>
</li>
<li>
<p><strong>All KDE applications built with Qt can run from the TTY using these framebuffer platforms</strong> like <code>kolourpaint</code> you can play games like <code>doom</code> also.</p>
</li>
<li>
<p>Use <code>Control+Z</code> to get back to the TTY and <code>fg</code> to reopen the qt application.</p>
</li>
<li>
<p>when using ffmpeg to record, you can capture any qt application with the <code>linuxfb</code> platform, but recording is not possible if you are using <code>elgfs</code>.</p>
</li>
</ul>
<pre><code class="language-bash"># You need to open the live dashboard first.  
  
falkon &quot;https://www.youtube.com/live_dashboard&quot;  
  
### Stream to YouTube only tty.  
ffmpeg -f alsa -i pipewire -thread_queue_size 1024 -f fbdev -framerate 60 -i /dev/fb0 -c:v libx264 -preset ultrafast -tune zerolatency -pix_fmt yuv420p -c:a aac -b:a 128k -f flv -async 1 -ar 48000 -latency 100 -bufsize 1000k rtmp://a.rtmp.youtube.com/live2/KEY 2&gt; /dev/null  
  
#### Stream to YouTube TTY with camera.  
ffmpeg -f alsa -i pipewire -thread_queue_size 1024 -f fbdev -framerate 60 -i /dev/fb0 -f v4l2 -framerate 60 -video_size 320x240 -i /dev/video0 -filter_complex &quot;[2:v]scale=320:240[cam];[1:v][cam]overlay=main_w-overlay_w-10:main_h-overlay_h-10[outv]&quot; -map &quot;[outv]&quot; -map 0:a -c:v libx264 -preset ultrafast -tune zerolatency -pix_fmt yuv420p -c:a aac -b:a 128k -f flv -bufsize 1000k rtmp://a.rtmp.youtube.com/live2/KEY 2&gt; /dev/null  
  
### Stream to YouTube full cam.  
ffmpeg -f alsa -i pipewire -thread_queue_size 1024 -f v4l2 -framerate 60 -video_size 1280x720 -i /dev/video0 -c:v libx264 -preset ultrafast -tune zerolatency -pix_fmt yuv420p -c:a aac -b:a 128k -f flv -bufsize 1000k rtmp://a.rtmp.youtube.com/live2/KEY 2&gt; /dev/null  
  
### Record video.  
ffmpeg -f alsa -i pipewire -f fbdev -r 30 -i /dev/fb0 record.mp4  
  
</code></pre>
<h4><strong>5. Additional Tips and Useful Tools</strong></h4>
<ul>
<li>
<p><strong>Mouse Usage in TTY:</strong></p>
<ul>
<li>You need to use <code>GPM</code> to have mouse support in the TTY: <code>sudo systemctl start gpm</code>.</li>
</ul>
</li>
<li>
<p><strong>Copy and Paste Text from Graphical Browser:</strong></p>
<ul>
<li>This is the solution I use I'm sure there's better: I use <code>ttyd</code> a web terminal, to copy text (e.g., from <code>qutebrowser</code>), paste it into <code>vim</code> in  ttyd.</li>
</ul>
</li>
</ul>
<p>My current alias for web-browsing:</p>
<pre><code class="language-bash">alias dgg 'w3m  dgg.gg'
alias mojeek &quot;w3m https://www.mojeek.com/search?q=hola&quot;
alias wiby &quot;w3m http://wiby.org&quot;
alias news &quot;netsurf-fb -f sdl -w 1366 -h 768 news.ycombinator.com&quot;
alias doom 'cd doom; bash play_doom.sh;'
alias rcommandline &quot;w3m old.reddit.com/r/commandline&quot;
alias google 'w3m https://leta.mullvad.net/search?q=google&amp;engine=google'
alias images=&quot;w3m https://pinterest.lurkmore.com/&quot;
alias lyrics=&quot;w3m https://genius.lurkmore.com/&quot;
</code></pre>
<h4>Upload files from tty to archive.</h4>
<pre><code class="language-bash">python -m venv internetarchive
pip install internetarchive
source internetarchive/bin/activate.fish
ia upload tag *.jpg
ia metadata tag
</code></pre>
</body>
</html>
